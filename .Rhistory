school_yr != "2020-2021") |>
group_by(school_yr, Client) |>
slice(1) |>
select(Client, Month_txt)
#graphing this information in boxplot
all_years |>
group_by(Client, school_yr) |>
summarize(hours_per_yr = sum(Hours)) |>
filter(!is.na(hours_per_yr),
hours_per_yr < 100) |>
arrange(hours_per_yr, school_yr) |>
ungroup() |>
mutate(year_color_type = if_else(school_yr == "2025-2026", "firebrick3", "gray40")) |>
ggplot(aes(x = hours_per_yr, y = school_yr, color = year_color_type)) +
geom_boxplot() +
scale_color_identity() +
scale_x_continuous(breaks = seq(0, 150, by = 5)) +
theme_bw() +
labs(x = "Total Tutoring Hours per Client",
y = "School Year",
title = "Hours of Tutoring Per Client Throughout the Year")
profit_25 <- c()
index <- 1
#| label: calculate-profit-over-time
#| echo: false
#function to calculate profit given dataset and date
calculate_profit <- function(dataset, date) {
profit <- dataset |>
filter(Date <= date) |>
summarize(sum = sum(Profit)) |>
pull(sum)
return(profit)
}
#pull each year's dates into list
dates_20 <- lessons_20 |>
distinct(Date) |>
pull(Date)
dates_21 <- lessons_21 |>
distinct(Date) |>
pull(Date)
dates_22 <- lessons_22 |>
distinct(Date) |>
pull(Date)
dates_23 <- lessons_23 |>
distinct(Date) |>
pull(Date)
dates_24 <- lessons_24 |>
distinct(Date) |>
pull(Date)
dates_25 <- lessons_25 |>
distinct(Date) |>
pull(Date)
#add to list the sum at each date
profit_20 <- numeric(length(lessons_20$Date))
index <- 1
for (date in dates_20) {
new_element <- calculate_profit(lessons_20, date)
while (index <= nrow(lessons_20) &
!is.na(lessons_20$Date[index]) &
lessons_20$Date[index] == as.Date(date)) {
profit_20[index] <- new_element
index <- index + 1
}
}
profit_21 <- numeric(length(lessons_21$Date))
index <- 1
for (date in dates_21) {
new_element <- calculate_profit(lessons_21, date)
while (index <= nrow(lessons_21) &
!is.na(lessons_21$Date[index]) &
lessons_21$Date[index] == as.Date(date)) {
profit_21[index] <- new_element
index <- index + 1
}
}
profit_22 <- c()
index <- 1
for (date in dates_22) {
new_element <- calculate_profit(lessons_22, date)
while (index <= nrow(lessons_22) & lessons_22$Date[index] == as.Date(date)) {
profit_22[index] <- new_element
index <- index + 1
}
}
profit_23 <- c()
index <- 1
for (date in dates_23) {
new_element <- calculate_profit(lessons_23, date)
while (index <= nrow(lessons_23) & lessons_23$Date[index] == as.Date(date)) {
profit_23[index] <- new_element
index <- index + 1
}
}
profit_24 <- c()
index <- 1
for (date in dates_24) {
new_element <- calculate_profit(lessons_24, date)
while (index <= nrow(lessons_24) & lessons_24$Date[index] == as.Date(date)) {
profit_24[index] <- new_element
index <- index + 1
}
}
profit_25 <- c()
index <- 1
for (date in dates_25) {
new_element <- calculate_profit(lessons_25, date)
while (index <= nrow(lessons_25) & lessons_25$Date[index] == as.Date(date)) {
profit_24[index] <- new_element
index <- index + 1
}
}
lessons_20$total_profit <- profit_20
lessons_21$total_profit <- profit_21
lessons_22$total_profit <- profit_22
lessons_23$total_profit <- profit_23
lessons_24$total_profit <- profit_24
lessons_25$total_profit <- profit_25
#delete one row that has a 20k total_profit
lessons_21 <- lessons_21 |>
filter(Date != "2022-12-31")
#join data to one set
cumulative_profit <- lessons_20 |>
full_join(lessons_21 |>
slice(1:1573)) |>
full_join(lessons_22) |>
full_join(lessons_23) |>
full_join(lessons_24) |>
full_join(lessons_25) |>
mutate(Year = format(Date, format = "%y"), .before = Date,
Day = format(Date, format = "%d"),
Month = format(Date, format = "%m"),
Date_No_Year = format(Date, format = "%m-%d"),
Profit = Revenue - Expense) |>
mutate(Month = fct_relevel(Month, "08", "09", "10", "11", "12", "01", "02",
"03", "04", "05", "06", "07")) |>
mutate(Month = as.numeric(as.character(Month))) |>
mutate(Month_txt = my_month_names[as.numeric(Month)], .after = Month) |>
mutate(Month_txt = fct_relevel(Month_txt,
"August",
"September",
"October",
"November",
"December",
"January",
"February",
"March",
"April",
"May",
"June",
"July"))
#FILTER DATE HERE
cumulative_profit <- cumulative_profit |>
filter(Date >= "2018-08-01",
Date <= "2026-06-15") |>
filter(Date_No_Year > "08-01" | Date_No_Year < "06-15")
#group_by date so that only one row per day
cumulative_profit <- cumulative_profit |>
group_by(school_yr, Month_txt, Month, Date) |>
summarize(total_profit = max(total_profit))
#graph
cumulative_profit |>
group_by(school_yr, Month_txt) |>
summarize(total_profit = max(total_profit)) |>
ggplot(aes(x = Month_txt, y = total_profit, color = school_yr)) +
geom_point() +
theme(axis.text.x = element_blank()) +
scale_color_viridis_d() +
theme_bw() +
labs(x = "Month",
y = "Total Profit",
color = "School Year",
title = "Total Profit over Time") +
scale_y_continuous(breaks = seq(0, 700000, by = 2000), label = dollar_format()) +
theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust = 1))
#| label: linear graph for total profit
cumulative_profit |>
group_by(Month_txt, school_yr) |>
summarize(total_profit = max(total_profit)) |>
ggplot(aes(x = Month_txt,
y = total_profit,
color = school_yr,
group = school_yr)) +
geom_point() +
geom_smooth(method = "lm",
fullrange = TRUE,
se = FALSE,
level = .95) + #confidence interval
theme(axis.text.x = element_blank()) +
scale_color_viridis_d() +
theme_bw() +
labs(x = "Month",
y = "Total Profit",
color = "School Year",
title = "Projected Profit over Time") +
scale_y_continuous(breaks = seq(0, 100000, by = 10000),
label = dollar_format()) +
theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust = 1))
#group_by date so that only one row per day
cumulative_profit <- cumulative_profit |>
group_by(school_yr, Month_txt, Month, Date) |>
summarize(total_profit = max(total_profit))
cumulative_profit
#| label: calculate-profit-over-time
#| echo: false
#function to calculate profit given dataset and date
calculate_profit <- function(dataset, date) {
profit <- dataset |>
filter(Date <= date) |>
summarize(sum = sum(Profit)) |>
pull(sum)
return(profit)
}
#pull each year's dates into list
dates_20 <- lessons_20 |>
distinct(Date) |>
pull(Date)
dates_21 <- lessons_21 |>
distinct(Date) |>
pull(Date)
dates_22 <- lessons_22 |>
distinct(Date) |>
pull(Date)
dates_23 <- lessons_23 |>
distinct(Date) |>
pull(Date)
dates_24 <- lessons_24 |>
distinct(Date) |>
pull(Date)
dates_25 <- lessons_25 |>
distinct(Date) |>
pull(Date)
#add to list the sum at each date
profit_20 <- numeric(length(lessons_20$Date))
index <- 1
for (date in dates_20) {
new_element <- calculate_profit(lessons_20, date)
while (index <= nrow(lessons_20) &
!is.na(lessons_20$Date[index]) &
lessons_20$Date[index] == as.Date(date)) {
profit_20[index] <- new_element
index <- index + 1
}
}
profit_21 <- numeric(length(lessons_21$Date))
index <- 1
for (date in dates_21) {
new_element <- calculate_profit(lessons_21, date)
while (index <= nrow(lessons_21) &
!is.na(lessons_21$Date[index]) &
lessons_21$Date[index] == as.Date(date)) {
profit_21[index] <- new_element
index <- index + 1
}
}
profit_22 <- c()
index <- 1
for (date in dates_22) {
new_element <- calculate_profit(lessons_22, date)
while (index <= nrow(lessons_22) & lessons_22$Date[index] == as.Date(date)) {
profit_22[index] <- new_element
index <- index + 1
}
}
profit_23 <- c()
index <- 1
for (date in dates_23) {
new_element <- calculate_profit(lessons_23, date)
while (index <= nrow(lessons_23) & lessons_23$Date[index] == as.Date(date)) {
profit_23[index] <- new_element
index <- index + 1
}
}
profit_24 <- c()
index <- 1
for (date in dates_24) {
new_element <- calculate_profit(lessons_24, date)
while (index <= nrow(lessons_24) & lessons_24$Date[index] == as.Date(date)) {
profit_24[index] <- new_element
index <- index + 1
}
}
profit_25 <- c()
index <- 1
for (date in dates_25) {
new_element <- calculate_profit(lessons_25, date)
while (index <= nrow(lessons_25) & lessons_25$Date[index] == as.Date(date)) {
profit_24[index] <- new_element
index <- index + 1
}
}
lessons_20$total_profit <- profit_20
lessons_21$total_profit <- profit_21
lessons_22$total_profit <- profit_22
lessons_23$total_profit <- profit_23
lessons_24$total_profit <- profit_24
lessons_25$total_profit <- profit_25
#delete one row that has a 20k total_profit
lessons_21 <- lessons_21 |>
filter(Date != "2022-12-31")
#join data to one set
cumulative_profit <- lessons_20 |>
full_join(lessons_21 |>
slice(1:1573)) |>
full_join(lessons_22) |>
full_join(lessons_23) |>
full_join(lessons_24) |>
full_join(lessons_25) |>
mutate(Year = format(Date, format = "%y"), .before = Date,
Day = format(Date, format = "%d"),
Month = format(Date, format = "%m"),
Date_No_Year = format(Date, format = "%m-%d"),
Profit = Revenue - Expense) |>
mutate(Month = fct_relevel(Month, "08", "09", "10", "11", "12", "01", "02",
"03", "04", "05", "06", "07")) |>
mutate(Month = as.numeric(as.character(Month))) |>
mutate(Month_txt = my_month_names[as.numeric(Month)], .after = Month) |>
mutate(Month_txt = fct_relevel(Month_txt,
"August",
"September",
"October",
"November",
"December",
"January",
"February",
"March",
"April",
"May",
"June",
"July"))
#FILTER DATE HERE
cumulative_profit <- cumulative_profit |>
filter(Date >= "2018-08-01",
Date <= "2026-06-15") |>
filter(Date_No_Year > "08-01" | Date_No_Year < "06-15")
#group_by date so that only one row per day
cumulative_profit <- cumulative_profit |>
group_by(school_yr, Month_txt, Month, Date) |>
summarize(total_profit = max(total_profit))
#| label: calculate-profit-over-time
#| echo: false
#function to calculate profit given dataset and date
calculate_profit <- function(dataset, date) {
profit <- dataset |>
filter(Date <= date) |>
summarize(sum = sum(Profit)) |>
pull(sum)
return(profit)
}
#pull each year's dates into list
dates_20 <- lessons_20 |>
distinct(Date) |>
pull(Date)
dates_21 <- lessons_21 |>
distinct(Date) |>
pull(Date)
dates_22 <- lessons_22 |>
distinct(Date) |>
pull(Date)
dates_23 <- lessons_23 |>
distinct(Date) |>
pull(Date)
dates_24 <- lessons_24 |>
distinct(Date) |>
pull(Date)
dates_25 <- lessons_25 |>
distinct(Date) |>
pull(Date)
#add to list the sum at each date
profit_20 <- numeric(length(lessons_20$Date))
index <- 1
for (date in dates_20) {
new_element <- calculate_profit(lessons_20, date)
while (index <= nrow(lessons_20) &
!is.na(lessons_20$Date[index]) &
lessons_20$Date[index] == as.Date(date)) {
profit_20[index] <- new_element
index <- index + 1
}
}
profit_21 <- numeric(length(lessons_21$Date))
index <- 1
for (date in dates_21) {
new_element <- calculate_profit(lessons_21, date)
while (index <= nrow(lessons_21) &
!is.na(lessons_21$Date[index]) &
lessons_21$Date[index] == as.Date(date)) {
profit_21[index] <- new_element
index <- index + 1
}
}
profit_22 <- c()
index <- 1
for (date in dates_22) {
new_element <- calculate_profit(lessons_22, date)
while (index <= nrow(lessons_22) & lessons_22$Date[index] == as.Date(date)) {
profit_22[index] <- new_element
index <- index + 1
}
}
profit_23 <- c()
index <- 1
for (date in dates_23) {
new_element <- calculate_profit(lessons_23, date)
while (index <= nrow(lessons_23) & lessons_23$Date[index] == as.Date(date)) {
profit_23[index] <- new_element
index <- index + 1
}
}
profit_24 <- c()
index <- 1
for (date in dates_24) {
new_element <- calculate_profit(lessons_24, date)
while (index <= nrow(lessons_24) & lessons_24$Date[index] == as.Date(date)) {
profit_24[index] <- new_element
index <- index + 1
}
}
profit_25 <- c()
index <- 1
for (date in dates_25) {
new_element <- calculate_profit(lessons_25, date)
while (index <= nrow(lessons_25) & lessons_25$Date[index] == as.Date(date)) {
profit_25[index] <- new_element
index <- index + 1
}
}
lessons_20$total_profit <- profit_20
lessons_21$total_profit <- profit_21
lessons_22$total_profit <- profit_22
lessons_23$total_profit <- profit_23
lessons_24$total_profit <- profit_24
lessons_25$total_profit <- profit_25
#delete one row that has a 20k total_profit
lessons_21 <- lessons_21 |>
filter(Date != "2022-12-31")
#join data to one set
cumulative_profit <- lessons_20 |>
full_join(lessons_21 |>
slice(1:1573)) |>
full_join(lessons_22) |>
full_join(lessons_23) |>
full_join(lessons_24) |>
full_join(lessons_25) |>
mutate(Year = format(Date, format = "%y"), .before = Date,
Day = format(Date, format = "%d"),
Month = format(Date, format = "%m"),
Date_No_Year = format(Date, format = "%m-%d"),
Profit = Revenue - Expense) |>
mutate(Month = fct_relevel(Month, "08", "09", "10", "11", "12", "01", "02",
"03", "04", "05", "06", "07")) |>
mutate(Month = as.numeric(as.character(Month))) |>
mutate(Month_txt = my_month_names[as.numeric(Month)], .after = Month) |>
mutate(Month_txt = fct_relevel(Month_txt,
"August",
"September",
"October",
"November",
"December",
"January",
"February",
"March",
"April",
"May",
"June",
"July"))
#FILTER DATE HERE
cumulative_profit <- cumulative_profit |>
filter(Date >= "2018-08-01",
Date <= "2026-06-15") |>
filter(Date_No_Year > "08-01" | Date_No_Year < "06-15")
#group_by date so that only one row per day
cumulative_profit <- cumulative_profit |>
group_by(school_yr, Month_txt, Month, Date) |>
summarize(total_profit = max(total_profit))
#graph
cumulative_profit |>
group_by(school_yr, Month_txt) |>
summarize(total_profit = max(total_profit)) |>
ggplot(aes(x = Month_txt, y = total_profit, color = school_yr)) +
geom_point() +
theme(axis.text.x = element_blank()) +
scale_color_viridis_d() +
theme_bw() +
labs(x = "Month",
y = "Total Profit",
color = "School Year",
title = "Total Profit over Time") +
scale_y_continuous(breaks = seq(0, 700000, by = 2000), label = dollar_format()) +
theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust = 1))
#| label: linear graph for total profit
cumulative_profit |>
group_by(Month_txt, school_yr) |>
summarize(total_profit = max(total_profit)) |>
ggplot(aes(x = Month_txt,
y = total_profit,
color = school_yr,
group = school_yr)) +
geom_point() +
geom_smooth(method = "lm",
fullrange = TRUE,
se = FALSE,
level = .95) + #confidence interval
theme(axis.text.x = element_blank()) +
scale_color_viridis_d() +
theme_bw() +
labs(x = "Month",
y = "Total Profit",
color = "School Year",
title = "Projected Profit over Time") +
scale_y_continuous(breaks = seq(0, 100000, by = 10000),
label = dollar_format()) +
theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust = 1))
