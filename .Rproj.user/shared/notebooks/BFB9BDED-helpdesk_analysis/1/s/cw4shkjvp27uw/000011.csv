"0","#| label: Patients by Age"
"0","data <- data |>"
"0","  mutate(age_bins = case_when("
"0","    age_at_encounter >= 15 & age_at_encounter < 25 ~ ""15-25"","
"0","    age_at_encounter >= 25 & age_at_encounter < 35 ~ ""25-35"","
"0","    age_at_encounter >= 35 & age_at_encounter < 45 ~ ""35-45"","
"0","    age_at_encounter >= 45 & age_at_encounter < 55 ~ ""45-55"","
"0","    age_at_encounter >= 55 & age_at_encounter < 65 ~ ""55-65"","
"0","    age_at_encounter >= 65 ~ ""65+"""
"0","  ))"
"0",""
"0","data |>"
"0","  count(age_bins) |>"
"0","  mutate(prop = round(100 * n/sum(n), 0)) |>"
"0","  filter(!is.na(age_bins)) |>"
"0","  ggplot(aes(x = age_bins, y = prop)) +"
"0","  geom_bar(stat = ""identity"", fill = ""lightblue"", color = ""gray"") +"
"0","  theme_bw() +"
"0","  labs(x = ""Age"","
"0","       y = ""Percent"") +"
"0","  geom_text(aes(label = if_else(n > 1,"
"0","                                paste(prop, "
"0","                                      ""% ("","
"0","                                      n,"
"0","                                      "")"","
"0","                                      sep = """"), """")), "
"0","            vjust = 1.5, "
"0","            size = 3)"
