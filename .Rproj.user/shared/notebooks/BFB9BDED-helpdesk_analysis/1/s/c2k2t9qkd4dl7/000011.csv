"0","#| label: needs breakdownd"
"0","needs <- data |>"
"0","  select(contains(""needs"")) |>"
"0","  summarize(total1 = sum(needs___1),"
"0","            total2 = sum(needs___2),"
"0","            total3 = sum(needs___3),"
"0","            total4 = sum(needs___4),"
"0","            total5 = sum(needs___5),"
"0","            total6 = sum(needs___6),"
"0","            total7 = sum(needs___7),"
"0","            total8 = sum(needs___8),"
"0","            total9 = sum(needs___9),"
"0","            total10 = sum(needs___10),"
"0","            total11 = sum(needs___11),"
"0","            total12 = sum(needs___12)) |>"
"0","  mutate(total = 0) |>"
"0","  pivot_longer(!total, names_to = ""need_category"", values_to = ""count"") |>"
"0","  select(!total) |>"
"0","  mutate(need = case_when("
"0","    need_category == ""total1"" ~ ""Food"","
"0","    need_category == ""total2"" ~ ""Clothing"","
"0","    need_category == ""total3"" ~ ""Child care"","
"0","    need_category == ""total4"" ~ ""Utilities"","
"0","    need_category == ""total5"" ~ ""Medicine/Health Care"","
"0","    need_category == ""total6"" ~ ""Phone"","
"0","    need_category == ""total7"" ~ ""No Answer"","
"0","    need_category == ""total8"" ~ ""Other"","
"0","    need_category == ""total9"" ~ ""None"","
"0","    need_category == ""total10"" ~ ""Housing"","
"0","    need_category == ""total11"" ~ ""Internet"","
"0","    need_category == ""total12"" ~ ""Transportation"","
"0","  )) |>"
"0","  mutate(prop = count/sum(count) * 100) #change to prop by prop = count/sum(count)"
"0",""
"0","needs |>"
"0","  mutate(prop = round(prop, digits = 0),"
"0","         need = fct_relevel(need, ""Other"", ""None"", ""No Answer"")) |>"
"0","  filter(need != ""No Answer"") |>"
"0","  ggplot(aes(x = need, y = prop, fill = need)) +"
"0","  geom_bar(width = 1, stat = ""identity"", color = ""black"", show.legend = FALSE) +"
"0","  theme_light() +"
"0","  labs(x = """", "
"0","       y = ""Percent of Patients"", "
"0","       title = ""Needs Breakdown"") +"
"0","  geom_text(aes(label = paste(""N = "", count)), hjust = 1.05, size = 3) +"
"0","  geom_text(aes(label = if_else(count < 350, paste(prop, ""%"", sep = """"), """")),"
"0","            hjust = -.3,"
"0","            size = 3) +"
"0","  coord_flip() +"
"0","  geom_text(aes(label = if_else(count > 350, paste(prop, ""%"", sep = """"), """")),"
"0","            hjust = 1,"
"0","            vjust = 3.5,"
"0","            size = 3)"
