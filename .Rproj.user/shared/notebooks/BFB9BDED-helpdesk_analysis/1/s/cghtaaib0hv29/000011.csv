"0","#| label: patients by gender"
"0","data <- data |>"
"0","  mutate(gender_txt = case_when("
"0","    gender == 1 ~ ""Man"","
"0","    gender == 2 ~ ""Woman"","
"0","    gender == 3 ~ ""Transgender"","
"0","    gender == 4 ~ ""Non-conforming"","
"0","    gender == 5 ~ ""Other"""
"0","  ))"
"0",""
"0","data |>"
"0","  count(gender_txt) |>"
"0","  filter(gender_txt == ""Man"" "
"0","         | gender_txt == ""Woman"""
"0","         | gender_txt == ""Other"""
"0","         | is.na(gender_txt)) |>"
"0","  mutate(prop = round(100 * n/sum(n), 0)) |>"
"0","  ggplot(aes(x = gender_txt, y = prop)) +"
"0","  geom_bar(stat = ""identity"", fill = ""lightblue"", color = ""gray"") +"
"0","  theme_bw() +"
"0","  labs(x = ""Gender"","
"0","       y = ""Percent"") +"
"0","  geom_text(aes(label = if_else(n > 1,"
"0","                                paste(prop, "
"0","                                      ""% ("","
"0","                                      n,"
"0","                                      "")"","
"0","                                      sep = """"), """")), vjust = 1.5)"
